# AWS-Deploy 步驟 4：檔案傳輸

## 具體操作指令
上傳 BESshow 專案檔案到 EC2 實例，準備部署環境

## 輸入參數與說明
- 目標伺服器：43.198.12.223
- SSH 金鑰：/home/ksu/bess/besshow/.key/besshow-key.pem
- 傳輸方式：rsync (排除不必要檔案)
- 目標目錄：/home/ubuntu/besshow

## 輸出結果與說明
- 所有專案檔案已成功上傳到 EC2 實例
- 測試環境 Docker 配置檔案已就緒
- 部署腳本具備執行權限
- 下一步：可以開始在 EC2 上安裝 Docker 並啟動服務

📝 **傳輸結果記錄**：
- 傳輸檔案數：173 個
- 總大小：12.6MB
- 傳輸速度：3.14MB/s
- 排除目錄：_dev_logs, __pycache__, .git, media, .venv, node_modules

## 執行步驟

### 4.1 測試 SSH 連線
```bash
$ ssh -i .key/besshow-key.pem -o ConnectTimeout=10 ubuntu@43.198.12.223 "echo 'SSH connection successful'"
SSH connection successful
```
✅ SSH 連線測試成功
- 可正常連接到 EC2 實例

### 4.2 建立目標目錄
```bash
$ ssh -i .key/besshow-key.pem ubuntu@43.198.12.223 "mkdir -p /home/ubuntu/besshow"
```
✅ 目標目錄建立成功
- 目錄：/home/ubuntu/besshow

### 4.3 使用 rsync 傳輸檔案
```bash
$ rsync -avz --progress -e "ssh -i besshow/.key/besshow-key.pem" --exclude='_dev_logs' --exclude='__pycache__' --exclude='.git' --exclude='media' --exclude='.venv' --exclude='node_modules' besshow/ ubuntu@43.198.12.223:/home/ubuntu/besshow/
# 傳輸 173 個檔案，總大小 12.6MB
# 速度：3.14MB/s
```
✅ 檔案傳輸成功
- 傳輸檔案數：173 個
- 總大小：12.6MB
- 排除不必要檔案：_dev_logs, __pycache__, .git, media, .venv

### 4.4 驗證傳輸結果
```bash
$ ssh -i .key/besshow-key.pem ubuntu@43.198.12.223 "ls -la /home/ubuntu/besshow/ | head -10"
# 顯示檔案清單，確認傳輸成功

$ ssh -i .key/besshow-key.pem ubuntu@43.198.12.223 "ls -la /home/ubuntu/besshow/docker-compose.staging.yml /home/ubuntu/besshow/.env.staging /home/ubuntu/besshow/scripts/deploy-staging.sh"
-rw-r--r-- 1 ubuntu ubuntu 165 Sep 12 09:52 /home/ubuntu/besshow/.env.staging
-rw-r--r-- 1 ubuntu ubuntu 666 Sep 12 09:52 /home/ubuntu/besshow/docker-compose.staging.yml
-rwxr-xr-x 1 ubuntu ubuntu 762 Sep 12 09:52 /home/ubuntu/besshow/scripts/deploy-staging.sh
```
✅ 重要檔案驗證成功
- Docker Compose 測試配置檔案已上傳
- 環境變數檔案已上傳
- 部署腳本已上傳且具備執行權限